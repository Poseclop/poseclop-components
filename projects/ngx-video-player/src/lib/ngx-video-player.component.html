<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<figure #figure>
  <video #video
    id="video-tag"
    [controls]="!browserSupportsVideo"
    preload="metadata"
    [poster]="poster"
    (loadedmetadata)="onMetadataLodaded()"
    (timeupdate)="onTimeUpdated()">
    <ng-content select="source"></ng-content>
  </video>
  <ul *ngIf="browserSupportsVideo" class="controls" aria-controls="video-tag">
    <li #progress
      tabindex="0"
      class="progress"
      (mousemove)="onProgressHover($event)"
      (keyup.ArrowRight)="advanceVideoBy(10)"
      (keyup.ArrowLeft)="advanceVideoBy(-10)">
        <progress *ngFor="let chapter of chapters | sort; let i = index"
          #chapterProgress
          tabindex="-1"
          [value]="video.currentTime - chapter.time"
          [max]="chapter.duration || 0"
          [style.width.%]="(chapter.duration || 0) / video.duration * 100"
          (click)="setVideoTime($event)"
          (keyup.ArrowRight)="advanceVideoBy(10)"
          (keyup.ArrowLeft)="advanceVideoBy(-10)"
          (focus)="onProgressHover()">
        </progress>
      <div class="thumbnail">
        <img [src]="thumbnailSrc" alt="">
        <p style="color: white" *ngIf="thumbnailTime">{{ thumbnailTime | chapter:chapters }}</p>
        <p style="color: white" *ngIf="thumbnailTime">{{ thumbnailTime | time }}</p>
      </div>
      <div class="chapters"></div>
    </li>
    <div class="buttons">
      <li><button type="button" (click)="toggleVideoPlayPause()">
        <span *ngIf="video.paused || video.ended; else pauseIcon" class="material-icons">play_arrow</span>
        <ng-template #pauseIcon><span class="material-icons">pause</span></ng-template>
      </button></li>
      <li><button type="button">
        <span class="material-icons">stop</span>
      </button></li>
      <li class="mute"><button type="button" (click)="video.muted = !video.muted">
        <span *ngIf="!video.muted; else muteIcon" class="material-icons">volume_up</span>
        <ng-template #muteIcon><span class="material-icons">volume_off</span></ng-template>
      </button></li>
      <li class="volume-control"><input type="range" min="0" max="1" step="0.1" (input)="onVolumeChange($event)"></li>
      <li class="text"><span>{{video.currentTime | time}} / {{video.duration | time}}</span></li>
      <li class="text"><span>&bull;</span><span style="margin-left: 4px">{{video.currentTime | chapter:chapters}} </span></li>
      <span style="flex-grow: 1;"></span>
      <li><button *ngIf="fullScreenEnabled" type="button" (click)="setFullScreen()"><span class="material-icons">fullscreen</span></button></li>
    </div>
  </ul>
</figure>
